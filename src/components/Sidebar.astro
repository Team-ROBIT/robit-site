---
// src/components/Sidebar.astro
import { getCollection } from 'astro:content';

// 1. 'archive' 컬렉션에서 모든 문서 가져오기
const allDocs = await getCollection('archive');

// 2. 대분류 그룹 정의 (기존 7개 탭 기준)
const groups = [
    { id: 'overview', title: 'Overview' },
    { id: 'contest', title: 'Contest' },
    { id: 'events', title: 'Events' },
    { id: 'articles', title: 'Articles' },
    { id: 'robots', title: 'Our Robots' },
    { id: 'members', title: 'People' },
    { id: 'contact', title: 'Contact' },
];

// 3. 문서를 그룹별로 분류하고 정렬
const menuItems = groups.map(group => {
    const items = allDocs
        .filter(doc => doc.slug.startsWith(group.id)) // 폴더명으로 필터링
        .sort((a, b) => (a.data.order || 0) - (b.data.order || 0)) // order 순으로 정렬
        .map(doc => ({
        name: doc.data.title,
        href: `/robit-site/${doc.slug}` // 예: /contest/awards-2025
        }));

    return {
        title: group.title,
        items: items.length > 0 ? items : [{ name: '준비 중...', href: '#' }]
    };
});
---

<nav class="space-y-6">
    {menuItems.map((group) => (
        <div>
        <h3 class="text-xs font-semibold text-zinc-500 uppercase tracking-wider mb-2 px-2">
            {group.title}
        </h3>
        <ul class="space-y-1">
            {group.items.map((item) => (
            <li>
                <a
                href={item.href}
                class="block px-2 py-1.5 text-sm text-zinc-600 dark:text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-900 hover:text-zinc-900 dark:hover:text-zinc-100 rounded-md transition-colors"
                >
                {item.name}
                </a>
            </li>
            ))}
        </ul>
        </div>
    ))}
</nav>